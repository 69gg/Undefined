# 定时任务助手

## 能力
- **创建任务**：使用 Crontab 表达式创建定时任务，可指定要执行的工具和参数
- **管理任务**：删除或修改现有的定时任务
- **查看任务**：列出当前所有活跃的定时任务，包括执行状态和次数

## 适用场景
- 当用户需要定期执行某项操作时（如定时提醒、定时查询、定时发送消息）
- 当用户说"每天早上8点提醒我..."、"每周一提醒..."、"明天下午3点..."等时
- 管理已有的定时任务（查看列表、修改时间、删除任务）
- 设置一次性提醒（如"明天提醒我提交周报"）

## 主 Agent 的职责

### 必须提供的信息

1. **工具名称 (tool_name)**
   - 提醒/通知类 → `send_message`
   - 其他功能 → 根据需求选择

2. **工具参数 (tool_args)**
   - send_message 的参数：`{"message": "提醒内容", "at_user": 123456}`
   - 其他工具 → 根据工具文档构造

### 可选提供的信息

主 Agent 可以选择性地提供以下信息，帮助 scheduler_agent 更准确地创建任务：

1. **时间信息**：如"每天早上8点"、"每周一早上9点"
   - 如果提供，scheduler_agent 直接使用
   - 如果不提供，scheduler_agent 从用户原始需求中推断

2. **任务名称**：如"每日喝水提醒"
   - 如果提供，scheduler_agent 直接使用
   - 如果不提供，scheduler_agent 自动生成

3. **执行次数**：如"只用提醒一次"、"提醒3次"
   - 如果提供，scheduler_agent 直接使用
   - 如果不提供，scheduler_agent 根据需求推断（一次性或永久）

### 优先级规则

1. 主 Agent 提供的信息优先使用
2. 主 Agent 未提供的信息，由 scheduler_agent 推断
3. scheduler_agent 无法推断的信息，向主 Agent 询问

## 调用示例

### 示例 1：仅提供必需信息
```json
{
  "prompt": "工具名称：send_message\n工具参数：{\"message\": \"喝水时间到啦，记得喝水！\"}"
}
```

### 示例 2：提供时间信息
```json
{
  "prompt": "工具名称：send_message\n工具参数：{\"message\": \"喝水时间到啦\"}\n时间：每天早上8点"
}
```

### 示例 3：提供完整信息
```json
{
  "prompt": "工具名称：send_message\n工具参数：{\"message\": \"喝水时间到啦\"}\n时间：每天早上8点\n任务名称：每日喝水提醒\n执行次数：只用提醒一次"
}
```

### 示例 4：查看任务列表
```json
{
  "prompt": "查看当前所有定时任务"
}
```

### 示例 5：删除任务
```json
{
  "prompt": "删除任务：task_daily_water_1234"
}
```

## 注意事项

1. **必需信息必须提供**：tool_name 和 tool_args 是必需的
2. **可选信息按需提供**：主 Agent 可以提供额外信息来减少推断
3. **信息不完整时**：scheduler_agent 会向主 Agent 询问
4. **时间格式**：可以口语化描述（"每天早上8点"），scheduler_agent 会转换
5. **任务名称**：主 Agent 提供则使用，否则自动生成

